{"session_id":"019ab730-4906-7b12-8569-c53c5dde1150","ts":1764009986,"text":"/"}
{"session_id":"019ab737-4612-7f91-bf54-c6a3b3870ee6","ts":1764010444,"text":"shell"}
{"session_id":"019ab73e-8c11-7ad2-b604-5987891db560","ts":1764010921,"text":"shell"}
{"session_id":"019ab73e-8c11-7ad2-b604-5987891db560","ts":1764010988,"text":"# /butler-exec — Execute a ButlerSpec\n\nPurpose: run a single ButlerSpec file with strict guardrails; never replan or modify other files.\n\nInvocation: `codex /butler-exec <SPEC_PATH>`\n- Arguments: `<SPEC_PATH>` MUST be a single ButlerSpec path (`*.butler.yaml`). Prefer an absolute path; relative paths must be resolved from the repo root that contains the target file.\n- Auth/environment: handled by Codex CLI. Do not request credentials; do not open browsers.\n\nExecution steps:\n1) Read the ButlerSpec YAML from `<SPEC_PATH>`. If the file is missing or unreadable, respond with `Error: spec file not found or unreadable` and stop.\n2) Validate guardrails before applying:\n   - Spec MUST declare exactly one `target_file` and no conflicting targets.\n   - Spec MUST have `actions` length between 1 and 25.\n   - Reject if metadata exceeds limits or the spec requests renames/signature changes/structural redesigns not explicitly described in the actions.\n   - If any guardrail fails, respond with `Error: <reason>` and do not emit a diff or tests block.\n3) Summarize the intent and actions (count + short bullet summaries) to anchor the edit.\n4) Apply only the specified actions to the `target_file`. Do NOT touch other files or lines outside the action ranges. No speculative edits, no formatting sweeps, no new files, no code fences.\n5) Tests: if `metadata.tests_to_run` contains a command, run it from the spec directory after applying changes and capture stdout/stderr/exit_code. If no test command is present, set status to `not_run` with reason `no_test_command`.\n\nOutput contract (exact shape):\n- On success:\n  ```\n  Summary: <1–2 lines: intent, target_file, actions count>\n  Diff:\n  <unified diff against target_file only, no extra text, no code fences>\n  Tests:\n  status=<ran|failed|not_run|timed_out|command_not_found|apply_failed>; command=<test command or none>; exit_code=<int or none>; stdout=<trimmed stdout or empty>; stderr=<trimmed stderr or empty>\n  ```\n  - Diff MUST be unified format and only include edits described by the actions. If no changes would be produced, respond with `Error: no diff produced`.\n- On guardrail failure (invalid spec, missing file, multi-target, >25 actions, forbidden rename/signature/structural change, etc.): respond with `Error: <reason>` only. Do NOT include `Diff:` or `Tests:` sections.\n\nNotes:\n- Never rewrite the spec file. Never batch multiple specs. Always keep edits confined to the declared target file.\n- Keep responses terse. If tests are skipped/not run, still emit the `Tests:` line with `status=not_run` and a reason.\n\nSample sanity check (expected shape):\n```\nSummary: Update docstring wording in foo.py (1 action)\nDiff:\ndiff --git a/foo.py b/foo.py\n--- a/foo.py\n+++ b/foo.py\n@@\n-def hello():\n-    \"\"\"hi\"\"\"\n+def hello():\n+    \"\"\"Say hello to the user.\"\"\"\nTests:\nstatus=not_run; command=none; exit_code=none; stdout=; stderr=\n```\nIf the spec is invalid or unreadable, return `Error: <reason>` instead of the above sections.\n"}
{"session_id":"019ab760-3d78-7fd0-9ea1-4c39e889b87b","ts":1764013319,"text":"# /butler-exec — Execute a ButlerSpec\n\nPurpose: run a single ButlerSpec file with strict guardrails; never replan or modify other files.\n\nInvocation: `codex /butler-exec <SPEC_PATH>`\n- Arguments: `<SPEC_PATH>` MUST be a single ButlerSpec path (`*.butler.yaml`). Prefer an absolute path; relative paths must be resolved from the repo root that contains the target file.\n- Auth/environment: handled by Codex CLI. Do not request credentials; do not open browsers.\n\nExecution steps:\n1) Read the ButlerSpec YAML from `<SPEC_PATH>`. If the file is missing or unreadable, respond with `Error: spec file not found or unreadable` and stop.\n2) Validate guardrails before applying:\n   - Spec MUST declare exactly one `target_file` and no conflicting targets.\n   - Spec MUST have `actions` length between 1 and 25.\n   - Reject if metadata exceeds limits or the spec requests renames/signature changes/structural redesigns not explicitly described in the actions.\n   - If any guardrail fails, respond with `Error: <reason>` and do not emit a diff or tests block.\n3) Summarize the intent and actions (count + short bullet summaries) to anchor the edit.\n4) Apply only the specified actions to the `target_file`. Do NOT touch other files or lines outside the action ranges. No speculative edits, no formatting sweeps, no new files, no code fences.\n5) Tests: if `metadata.tests_to_run` contains a command, run it from the spec directory after applying changes and capture stdout/stderr/exit_code. If no test command is present, set status to `not_run` with reason `no_test_command`.\n\nOutput contract (exact shape):\n- On success:\n  ```\n  Summary: <1–2 lines: intent, target_file, actions count>\n  Diff:\n  <unified diff against target_file only, no extra text, no code fences>\n  Tests:\n  status=<ran|failed|not_run|timed_out|command_not_found|apply_failed>; command=<test command or none>; exit_code=<int or none>; stdout=<trimmed stdout or empty>; stderr=<trimmed stderr or empty>\n  ```\n  - Diff MUST be unified format and only include edits described by the actions. If no changes would be produced, respond with `Error: no diff produced`.\n- On guardrail failure (invalid spec, missing file, multi-target, >25 actions, forbidden rename/signature/structural change, etc.): respond with `Error: <reason>` only. Do NOT include `Diff:` or `Tests:` sections.\n\nNotes:\n- Never rewrite the spec file. Never batch multiple specs. Always keep edits confined to the declared target file.\n- Keep responses terse. If tests are skipped/not run, still emit the `Tests:` line with `status=not_run` and a reason.\n\nSample sanity check (expected shape):\n```\nSummary: Update docstring wording in foo.py (1 action)\nDiff:\ndiff --git a/foo.py b/foo.py\n--- a/foo.py\n+++ b/foo.py\n@@\n-def hello():\n-    \"\"\"hi\"\"\"\n+def hello():\n+    \"\"\"Say hello to the user.\"\"\"\nTests:\nstatus=not_run; command=none; exit_code=none; stdout=; stderr=\n```\nIf the spec is invalid or unreadable, return `Error: <reason>` instead of the above sections.\n"}
{"session_id":"019ab760-3d78-7fd0-9ea1-4c39e889b87b","ts":1764013345,"text":"# /butler-exec — Execute a ButlerSpec\n\nPurpose: run a single ButlerSpec file with strict guardrails; never replan or modify other files.\n\nInvocation: `codex /butler-exec <SPEC_PATH>`\n- Arguments: `<SPEC_PATH>` MUST be a single ButlerSpec path (`*.butler.yaml`). Prefer an absolute path; relative paths must be resolved from the repo root that contains the target file.\n- Auth/environment: handled by Codex CLI. Do not request credentials; do not open browsers.\n\nExecution steps:\n1) Read the ButlerSpec YAML from `<SPEC_PATH>`. If the file is missing or unreadable, respond with `Error: spec file not found or unreadable` and stop.\n2) Validate guardrails before applying:\n   - Spec MUST declare exactly one `target_file` and no conflicting targets.\n   - Spec MUST have `actions` length between 1 and 25.\n   - Reject if metadata exceeds limits or the spec requests renames/signature changes/structural redesigns not explicitly described in the actions.\n   - If any guardrail fails, respond with `Error: <reason>` and do not emit a diff or tests block.\n3) Summarize the intent and actions (count + short bullet summaries) to anchor the edit.\n4) Apply only the specified actions to the `target_file`. Do NOT touch other files or lines outside the action ranges. No speculative edits, no formatting sweeps, no new files, no code fences.\n5) Tests: if `metadata.tests_to_run` contains a command, run it from the spec directory after applying changes and capture stdout/stderr/exit_code. If no test command is present, set status to `not_run` with reason `no_test_command`.\n\nOutput contract (exact shape):\n- On success:\n  ```\n  Summary: <1–2 lines: intent, target_file, actions count>\n  Diff:\n  <unified diff against target_file only, no extra text, no code fences>\n  Tests:\n  status=<ran|failed|not_run|timed_out|command_not_found|apply_failed>; command=<test command or none>; exit_code=<int or none>; stdout=<trimmed stdout or empty>; stderr=<trimmed stderr or empty>\n  ```\n  - Diff MUST be unified format and only include edits described by the actions. If no changes would be produced, respond with `Error: no diff produced`.\n- On guardrail failure (invalid spec, missing file, multi-target, >25 actions, forbidden rename/signature/structural change, etc.): respond with `Error: <reason>` only. Do NOT include `Diff:` or `Tests:` sections.\n\nNotes:\n- Never rewrite the spec file. Never batch multiple specs. Always keep edits confined to the declared target file.\n- Keep responses terse. If tests are skipped/not run, still emit the `Tests:` line with `status=not_run` and a reason.\n\nSample sanity check (expected shape):\n```\nSummary: Update docstring wording in foo.py (1 action)\nDiff:\ndiff --git a/foo.py b/foo.py\n--- a/foo.py\n+++ b/foo.py\n@@\n-def hello():\n-    \"\"\"hi\"\"\"\n+def hello():\n+    \"\"\"Say hello to the user.\"\"\"\nTests:\nstatus=not_run; command=none; exit_code=none; stdout=; stderr=\n```\nIf the spec is invalid or unreadable, return `Error: <reason>` instead of the above sections.\n"}
